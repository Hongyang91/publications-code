function Grad_ejSig_i = ADPCLNNTSGradSigma(i,j,eSiC,xi,Si,NSet,n)

N=length(NSet);
eC=mat2cell(zeros(n*N,1),n*ones(N,1));
eC(Si)=eSiC;
xC=mat2cell(zeros(n*N,1),n*ones(N,1));
xC{i}=xi;

Grad_eSigC = cell(N,N);
Grad_xSigC = cell(N,1);

e1=eC{1};
e2=eC{2};
e3=eC{3};
e4=eC{4};
e5=eC{5};

x1=xC{1};
x2=xC{2};
x3=xC{3};
x4=xC{4};
x5=xC{5};

%--------------------------------------------------------------------------
% s1 = (1/2)*[e1^2;(1/2)*e1^4;e1^2*e2^2;e1^2*x1^2;e1^4*x1^2;e2^2];
% s2 = (1/2)*[e2^2;(1/2)*e2^4;e1^2*e2^2;e2^2*x2^2;e2^4*x2^2;e1^2];
% s3 = (1/2)*[e3^2;(1/2)*e3^4;e3^2*(x3)^2;e3^4*(x3)^2];
% s4 = (1/2)*[e4^2;(1/2)*e4^4;e4^2*e3^2;e4^2*x4^2;e3^2];
% s5 = (1/2)*[e5^2;(1/2)*e5^4;e5^2*e4^2;e5^2*e3^2;e5^2*x5^2;e3^2*e4^2;e3^2;e4^2];
%--------------------------------------------------------------------------

Grad_eSigC{1,1} = [ e1, e1^3, e1*x1^2, 0]';
Grad_eSigC{1,2} = [ 0, 0, 0, e2]';
Grad_xSigC{1}   = [ 0, 0, e1^2*x1, 0]';

Grad_eSigC{2,2} = [ e2, e2^3, e2*x2^2, 0]';  
Grad_eSigC{2,1} = [ 0, 0, 0, e1]';
Grad_xSigC{2}   = [ 0, 0, e2^2*x2, 0]';

Grad_eSigC{3,3} = [ e3, e3^3, e3*x3^2, 2*e3^3*x3^2]';
Grad_xSigC{3}   = [ 0, 0, e3^2*x3, e3^4*x3]';

Grad_eSigC{4,4} = [ e4, e4^3, e3^2*e4, e4*x4^2, 0]';
Grad_eSigC{4,3} = [ 0, 0, e3*e4^2, 0, e3]';
Grad_xSigC{4}   = [ 0, 0, 0, e4^2*x4, 0]';

Grad_eSigC{5,5} = [ e5, e5^3, e4^2*e5, e3^2*e5, e5*x5^2, 0, 0, 0]';
Grad_eSigC{5,3} = [ 0, 0, 0, e3*e5^2, 0,  e3*e4^2, e3, 0]';
Grad_eSigC{5,4} = [ 0, 0, e4*e5^2, 0, 0,  e3^2*e4, 0, e4]';
Grad_xSigC{5}   = [ 0, 0, 0, 0, e5^2*x5,  0, 0, 0]';


if j==0
    Grad_ejSig_i=Grad_xSigC{i};
else
    Grad_ejSig_i=Grad_eSigC{i,j};
end

%--------------------------------------------------------------------------------------------------------

% s1 = [e1(1)^2; e1(1)*e1(2); e1(2)^2; e3(1)^2; e3(1)*e3(2); e3(2)^2; x1(1)^2; x1(1)*x1(2); x1(2)^2];
% s2 = [e2(1)^2; e2(1)*e2(2); e2(2)^2; x2(1)^2; x2(1)*x2(2); x2(2)^2];
% s3 = [e3(1)^2; e3(1)*e3(2); e3(2)^2 ;e1(1)^2; e1(1)*e1(2); e1(2)^2;e3(1)*e1(1);e3(2)*e1(2);e3(2)*e1(1);e3(1)*e1(2);x3(1)^2; x3(1)*x3(2); x3(2)^2];
% s4 = [e4(1)^2; e4(1)*e4(2); e4(2)^2 ;e1(1)^2; e1(1)*e1(2); e1(2)^2;e4(1)*e1(1);e4(2)*e1(2);e4(2)*e1(1);e4(1)*e1(2);x4(1)^2; x4(1)*x4(2); x4(2)^2; e3(1)^2; e3(1)*e3(2); e3(2)^2];
% s5 = [e5(1)^2; e5(1)*e5(2); e5(2)^2 ;e2(1)^2; e2(1)*e2(2); e2(2)^2;e5(1)*e2(1);e5(2)*e2(2);e5(2)*e2(1);e5(1)*e2(2);x5(1)^2; x5(1)*x5(2); x5(2)^2];
% 
% Grad_eSigC{1,1} = [2*e1(1) e1(2) 0 0 0 0 0 0 0;0 e1(1) 2*e1(2) 0 0 0 0 0 0]';
% Grad_eSigC{1,3} = [0 0 0 2*e3(1) e3(2) 0 0 0 0;0 0 0 0 e3(1) 2*e3(2) 0 0 0]';      
% Grad_xSigC{1} = [0 0 0 0 0 0 2*x1(1) x1(2) 0;0 0 0 0 0 0 0 x1(1) 2*x1(2)]';
% Grad_eSigC{2,2} = [2*e2(1) e2(2) 0 0 0 0;0 e2(1) 2*e2(2) 0 0 0]';  
% Grad_xSigC{2} = [0 0 0 2*x2(1) x2(2) 0;0 0 0 0 x2(1) 2*x2(2)]';
% Grad_eSigC{3,3} = [2*e3(1) e3(2) 0 0 0 0 e1(1) 0 0 e1(2) 0 0 0;0 e3(1) 2*e3(2) 0 0 0 0 e1(2) e1(1) 0 0 0 0]';
% Grad_eSigC{3,1} = [0 0 0 2*e1(1) e1(2) 0 e3(1) 0 e3(2) 0 0 0 0;0 0 0 0 e1(1) 2*e1(2) 0 e3(2) 0 e3(1) 0 0 0]';
% Grad_xSigC{3} = [0 0 0 0 0 0 0 0 0 0 2*x3(1) x3(2) 0;0 0 0 0 0 0 0 0 0 0 0 x3(1) 2*x3(2)]';
% Grad_eSigC{4,4} = [2*e4(1) e4(2) 0 0 0 0 e1(1) 0 0 e1(2) 0 0 0 0 0 0;0 e4(1) 2*e4(2) 0 0 0 0 e1(2) e1(1) 0 0 0 0 0 0 0]';
% Grad_eSigC{4,1} = [0 0 0 2*e1(1) e1(2) 0 e4(1) 0 e4(2) 0 0 0 0 0 0 0;0 0 0 0 e1(1) 2*e1(2) 0 e4(2) 0 e4(1) 0 0 0 0 0 0]';
% Grad_eSigC{4,3} = [0 0 0 0 0 0 0 0 0 0 0 0 0 2*e3(1) e3(2) 0;0 0 0 0 0 0 0 0 0 0 0 0 0 0 e3(1) 2*e3(2)]';
% Grad_xSigC{4} = [0 0 0 0 0 0 0 0 0 0 2*x4(1) x4(2) 0 0 0 0;0 0 0 0 0 0 0 0 0 0 0 x4(1) 2*x4(2) 0 0 0]';
% Grad_eSigC{5,5} = [2*e5(1) e5(2) 0 0 0 0 e2(1) 0 0 e2(2) 0 0 0;0 e5(1) 2*e5(2) 0 0 0 0 e2(2) e2(1) 0 0 0 0]';
% Grad_eSigC{5,2} = [0 0 0 2*e2(1) e2(2) 0 e5(1) 0 e5(2) 0 0 0 0;0 0 0 0 e2(1) 2*e2(2) 0 e5(2) 0 e5(1) 0 0 0]';
% Grad_xSigC{5} = [0 0 0 0 0 0 0 0 0 0 2*x5(1) x5(2) 0;0 0 0 0 0 0 0 0 0 0 0 x5(1) 2*x5(2)]';
