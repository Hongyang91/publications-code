clear setup limits guess
t0 = 0; tf = 100;
time = [t0 tf];
x0 = [1.8 1.6 0 0];
xd = [(1/2)*cos(2*time') (1/3)*cos(3*time') -sin(2*time') -sin(3*time')];
zeta0 = [x0-xd(1,:) xd(1,:)]; 
zetaguess = [ones(length(time),4) xd];
zetafmax = [1e-1 1e-1 1e-1 1e-1 xd(end,:)];
zetafmin = [-1e-1 -1e-1 -1e-1 -1e-1 xd(end,:)];
zetamax = 20*[1 1 1 1 1 1 1 1];
iphase = 1;
limits(iphase).meshPoints = [-1 1];
limits(iphase).nodesPerInterval = 300;
limits(iphase).time.min = [t0 tf];
limits(iphase).time.max = [t0 tf];
limits(iphase).state.min = [zeta0'  -zetamax'  zetafmin'];
limits(iphase).state.max = [zeta0'  zetamax'  zetafmax'];
limits(iphase).control.min = [-60; -40];
limits(iphase).control.max = [60; 40];
limits(iphase).parameter.min = [];
limits(iphase).parameter.max = [];
limits(iphase).path.min = [];
limits(iphase).path.max = [];
limits(iphase).event.min = [];
limits(iphase).event.max = [];
guess(iphase).time = time';
guess(iphase).state = zetaguess;
guess(iphase).control = -5*ones(length(time),2);
guess(iphase).parameter = [];
setup.name = 'OC2LinkGPOPS';
setup.funcs.cost = 'OC2LinkGPOPSCost';
setup.funcs.dae = 'OC2LinkGPOPSdae';
setup.linkages = [];
setup.limits = limits;
setup.guess = guess;
setup.derivatives = 'finite-difference';
setup.checkDerivatives = 0;
setup.autoscale = 'off';
setup.mesh.tolerance = 1e-4;
setup.mesh.iteration = 0;
% setup.mesh.nodesPerInterval.min = 100;
% setup.mesh.nodesPerInterval.max = 100;
[output,gpopsHistory] = gpops(setup)